import{J as G,j as a,p as E,d as e,K as B,r as M,i as k,a as w,U as K,B as F,M as X,R as U,u as J,b as n,k as T,O as Y,C as L,P as Z,Q as ee,S as te,T as se,V as oe,W as q,X as ce,Y as ae,Z as ne,f as A,_ as re,$ as ie,a0 as le,a1 as R,a2 as _e,a3 as de,a4 as ue,a5 as fe,l as pe,a6 as me,a7 as he,D as be,a8 as ve,a9 as $e,aa as xe,ab as ge}from"./index-d2cceecc.js";const Ae="_container_1m6tu_107",Ne="_fieldWrapper_1m6tu_114",Ee="_fieldLabel_1m6tu_118",Le="_fieldErrorText_1m6tu_134",ye="_input_1m6tu_150",Se="_Account_1m6tu_180",Te={container:Ae,fieldWrapper:Ne,fieldLabel:Ee,fieldErrorText:Le,input:ye,Account:Se},We="_container_1e22d_107",Ie="_fieldWrapper_1e22d_114",De="_fieldLabel_1e22d_118",qe="_fieldErrorText_1e22d_134",Be="_input_1e22d_150",Me="_AccountBody_1e22d_180",ke="_header_1e22d_183",we="_about_1e22d_186",N={container:We,fieldWrapper:Ie,fieldLabel:De,fieldErrorText:qe,input:Be,AccountBody:Me,header:ke,about:we},Fe="_container_2c7cy_107",Ue="_fieldWrapper_2c7cy_114",Re="_fieldLabel_2c7cy_118",Ce="_fieldErrorText_2c7cy_134",Qe="_input_2c7cy_150",je="_AccountInfo_2c7cy_180",He="_title_2c7cy_188",Ve="_birthDate_2c7cy_204",Oe="_classNum_2c7cy_207",Pe="_rating_2c7cy_210",ze="_AccountSchool_2c7cy_213",Ge="_school_2c7cy_216",$={container:Fe,fieldWrapper:Ue,fieldLabel:Re,fieldErrorText:Ce,input:Qe,AccountInfo:je,title:He,birthDate:Ve,classNum:Oe,rating:Pe,AccountSchool:ze,school:Ge},Ke=({accountData:t,className:s})=>{const{class:_,birthDate:c,rating:r,school:o}=t;let i=null;return console.log("birthDate",c),c&&(i=G(new Date().getTime())),a("ul",{className:E($.AccountInfo,s),children:[e("h3",{className:$.title,children:"Деталі"}),e("li",{className:$.classNum,children:a("p",{children:[_," клас"]})}),c&&e("li",{className:$.birthDate,children:e("span",{children:i})}),e("li",{className:$.rating,children:e("p",{children:r})}),e("li",{className:$.AccountSchool,children:e(B,{to:o.website,title:"Сайт школи",target:"_blank",className:$.school,children:o.institution_name})})]})},Xe="_container_1c63k_107",Je="_fieldWrapper_1c63k_114",Ye="_fieldLabel_1c63k_118",Ze="_fieldErrorText_1c63k_134",et="_input_1c63k_150",tt="_AccountHeader_1c63k_180",st="_cover_1c63k_183",ot="_fullName_1c63k_190",ct="_editBtn_1c63k_214",at="_icon_1c63k_219",nt="_avatar_1c63k_224",g={container:Xe,fieldWrapper:Je,fieldLabel:Ye,fieldErrorText:Ze,input:et,AccountHeader:tt,cover:st,fullName:ot,editBtn:ct,icon:at,avatar:nt};var W={},rt=k;Object.defineProperty(W,"__esModule",{value:!0});var C=W.default=void 0,it=rt(M()),lt=w,_t=(0,it.default)((0,lt.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");C=W.default=_t;const dt=({className:t,fullName:s,avatarUrl:_,setIsEditing:c,isMy:r})=>{const o=()=>{c(!0)};return a("div",{className:E(g.AccountHeader,t),children:[a("div",{className:g.cover,children:[r&&e("button",{className:g.editBtn,onClick:o,children:e(C,{className:g.icon})}),e("h1",{className:g.fullName,children:s})]}),e(K,{className:g.avatar,src:_,fullName:s,size:"lg"})]})},ut="_container_ihipu_107",ft="_fieldWrapper_ihipu_114",pt="_fieldLabel_ihipu_118",mt="_fieldErrorText_ihipu_134",ht="_input_ihipu_150",bt="_MessageBtn_ihipu_180",vt="_btn_ihipu_180",$t="_link_ihipu_180",y={container:ut,fieldWrapper:ft,fieldLabel:pt,fieldErrorText:mt,input:ht,MessageBtn:bt,btn:vt,link:$t},xt=({className:t,uid:s})=>e("div",{className:E(y.MessageBtn,t),children:e(F,{color:"primary",variant:"outlined",startDecorator:e(X,{}),className:y.btn,children:e(B,{className:y.link,to:`/chat/${s}`,children:"Написати повідомлення"})})}),gt=U.memo(({accountData:t,isMy:s,setIsEditing:_})=>{const{aboutMe:c,avatarUrl:r,uid:o,fullName:i}=t;return a("div",{className:N.AccountBody,children:[e(dt,{avatarUrl:r,setIsEditing:_,fullName:i,isMy:s,className:N.header}),e("p",{className:N.about,children:c}),!s&&e(xt,{uid:o,className:N.messageBtn}),e(Ke,{accountData:t,className:N.info})]})}),At="_container_e4fx0_108",Nt="_fieldWrapper_e4fx0_115",Et="_fieldLabel_e4fx0_119",Lt="_fieldErrorText_e4fx0_135",yt="_input_e4fx0_151",St="_formWrapper_e4fx0_181",Tt="_form_e4fx0_181",Wt="_title_e4fx0_193",It="_body_e4fx0_213",Dt="_avatar_e4fx0_224",qt="_textFields_e4fx0_232",Bt="_top_e4fx0_235",Mt="_initialsInputs_e4fx0_244",kt="_avatarUpload_e4fx0_247",wt="_aboutMe_e4fx0_253",Ft="_schoolInfo_e4fx0_257",Ut="_selectSchool_e4fx0_257",v={container:At,fieldWrapper:Nt,fieldLabel:Et,fieldErrorText:Lt,input:yt,formWrapper:St,form:Tt,title:Wt,body:It,avatar:Dt,textFields:qt,top:Bt,initialsInputs:Mt,avatarUpload:kt,aboutMe:wt,schoolInfo:Ft,selectSchool:Ut},Rt=U.memo(({accountData:t,setIsEdit:s})=>{const{register:_,handleSubmit:c,watch:r,formState:{errors:o},control:i,setValue:d}=J(),[m,l]=n.useState(!1),[f,u]=n.useState(null),{birthDate:D,name:j,surname:H,school:us}=t||{},V=T(),O=async h=>{console.log("send data",t),l(!0),await V(ae(h)),console.log("sended"),l(!1),s(!1)};return n.useEffect(()=>{d("avatar",f)},[f]),e("div",{className:v.formWrapper,children:a("form",{className:v.form,onSubmit:c(O),children:[e("h2",{className:v.title,children:"Змінити дані профілю"}),a("div",{className:v.body,children:[a("div",{className:v.top,children:[e("div",{className:v.avatar,children:e(Y,{selectedFile:f,setSelectedFile:u,name:j,surname:H,size:96,existingAvatarUrl:t.avatarUrl||void 0})}),a("div",{className:v.textFields,children:[e(L,{control:i,name:"schoolInfo",rules:{required:"Це поле є обов'язковим",min:{value:1,message:"Тоді Ви ще не ходите в школу(1-12)"},max:{value:12,message:"Певно, Ви вже закінчили школу(1-12)"}},defaultValue:{label:t.school.institution_name,id:+t.school.institution_id},render:({field:{value:h}})=>{var x,b;return a(Z,{error:!!o.schoolInfo,required:!0,children:[e(ee,{children:"Навчальний заклад"}),e(te,{error:(x=o.schoolInfo)==null?void 0:x.message,setValue:(P,z)=>{d(P,z)},value:h,inputValue:h.label}),e(se,{children:(b=o.schoolInfo)==null?void 0:b.message})]})}}),e(L,{control:i,name:"class",defaultValue:t.class,render:({field:{value:h,onChange:x}})=>{var b;return e(oe,{error:(b=o.class)==null?void 0:b.message,onChange:x,value:h,required:!0})}})]})]}),e(L,{control:i,name:"aboutMe",defaultValue:t.aboutMe||"",rules:{maxLength:{value:q,message:`Повинно бути менше ${q} символів`}},render:({field:{value:h,onChange:x}})=>{var b;return e(ce,{error:(b=o.aboutMe)==null?void 0:b.message,onChange:x,value:h})}})]}),e(F,{className:v.submitBtn,type:"submit",children:"Зберегти"})]})})}),Ct="_container_13m56_107",Qt="_fieldWrapper_13m56_114",jt="_fieldLabel_13m56_118",Ht="_fieldErrorText_13m56_134",Vt="_input_13m56_150",Ot="_NoAccountData_13m56_180",Pt="_icon_13m56_188",zt="_text_13m56_193",S={container:Ct,fieldWrapper:Qt,fieldLabel:jt,fieldErrorText:Ht,input:Vt,NoAccountData:Ot,icon:Pt,text:zt},Gt=()=>a("div",{className:S.NoAccountData,children:[e(ne,{className:S.icon}),e("span",{className:S.text,children:"Користувач ще не вніс свої дані"})]}),Kt="_container_5vq3c_107",Xt="_fieldWrapper_5vq3c_114",Jt="_fieldLabel_5vq3c_118",Yt="_fieldErrorText_5vq3c_134",Zt="_input_5vq3c_150",es="_AccountQuestions_5vq3c_180",ts="_top_5vq3c_183",ss="_title_5vq3c_190",os="__open_5vq3c_205",cs="_arrow_5vq3c_205",as="_questionsList_5vq3c_213",p={container:Kt,fieldWrapper:Xt,fieldLabel:Jt,fieldErrorText:Yt,input:Zt,AccountQuestions:es,top:ts,title:ss,_open:os,arrow:cs,questionsList:as};var I={},ns=k;Object.defineProperty(I,"__esModule",{value:!0});var Q=I.default=void 0,rs=ns(M()),is=w,ls=(0,rs.default)((0,is.jsx)("path",{d:"M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7a.9959.9959 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"}),"KeyboardArrowDownRounded");Q=I.default=ls;const _s=({uid:t})=>{const s=A(re),_=A(ie),[c,r]=n.useState(!1),[o,i]=n.useState(!1),[d,m]=n.useState(null),l=n.useRef(null),f=T();return n.useEffect(()=>{s||(async()=>{r(!0),await f(ue(t)),r(!1)})()},[o]),n.useEffect(()=>()=>{f(le(null))},[]),n.useEffect(()=>{if(_&&l.current){const u=l.current.getBoundingClientRect().x,D=_+fe;m({right:u,bottom:D})}},[_,l.current]),n.useEffect(()=>{console.log("body scroll top",window.document.body.scrollTop)},[window.document.body.scrollTop]),console.log("condition",o&&!c&&l.current),a("div",{className:p.AccountQuestions,children:[a("button",{className:E(p.top,o&&p._open),onClick:()=>i(u=>!u),children:[a("h2",{className:p.title,children:["Запитання ",s&&`(${s.length})`]}),e(Q,{className:p.arrow})]}),e("div",{className:E(p.questionsList,o&&p._open),ref:l,children:c?e(R,{absolute:!0}):s?s.map(u=>e(_e,{data:u,isOpen:!1},u.id)):e("p",{className:p.noQuestions,children:"Немає запитань"})}),o&&!c&&window.document.body&&e("div",{className:p.ScrollBtnWrap,style:{position:"fixed",bottom:`${(d==null?void 0:d.bottom)||0}px`,right:`${(d==null?void 0:d.right)||0}px`},children:e(de,{isWindow:!0,up:!0})})]})},ds=({})=>{const[t,s]=n.useState(!0),[_,c]=n.useState(!1),r=A(pe),o=A(me),i=A(he),d=A(be),{userId:m}=ve(),l=m?o:r,f=!m;n.useEffect(()=>{s(!0),m&&u($e(m)),s(!1)},[m]),console.log("axxoun data",l);const u=T();return console.log("is fetching",i),d?i&&t||!r?e(R,{}):e("div",{className:Te.Account,children:!_&&l?a(ge,{children:[e(gt,{accountData:l,setIsEditing:c,isMy:f}),e(_s,{uid:l.uid})]}):f?e(Rt,{accountData:r,setIsEdit:c}):e(Gt,{})}):e(xe,{to:"/login",replace:!0})},ps=ds;export{ps as default};
