import{E as G,j as n,n as A,d as e,D,r as M,i as B,a as j,U as J,B as z,H as Y,R as F,J as U,K as k,T as Z,M as ee,u as te,b as u,g as S,N as R,O as se,C as L,S as ne,P as oe,Q as ae,V as ce,W as le,h as x,X as re,Y as ie,Z as Q,_ as ue,$ as _e,a0 as de,s as fe,a1 as me,a2 as he,y as pe,a3 as ve,a4 as be,a5 as ge}from"./index-ec30539c.js";const $e="_container_k1fpl_107",Ne="_fieldLabel_k1fpl_114",xe="_fieldErrorText_k1fpl_130",Ae="_input_k1fpl_146",Ee="_Account_k1fpl_175",Le={container:$e,fieldLabel:Ne,fieldErrorText:xe,input:Ae,Account:Ee},ye="_container_1d4fu_107",Te="_fieldLabel_1d4fu_114",Se="_fieldErrorText_1d4fu_130",qe="_input_1d4fu_146",Ie="_AccountBody_1d4fu_175",we="_header_1d4fu_178",De="_about_1d4fu_181",N={container:ye,fieldLabel:Te,fieldErrorText:Se,input:qe,AccountBody:Ie,header:we,about:De},Me="_container_1lywu_107",Be="_fieldLabel_1lywu_114",je="_fieldErrorText_1lywu_130",ze="_input_1lywu_146",Fe="_AccountInfo_1lywu_175",Ue="_title_1lywu_183",ke="_birthDate_1lywu_199",Re="_classNum_1lywu_202",Qe="_rating_1lywu_205",Ce="_AccountSchool_1lywu_208",He="_school_1lywu_211",p={container:Me,fieldLabel:Be,fieldErrorText:je,input:ze,AccountInfo:Fe,title:Ue,birthDate:ke,classNum:Re,rating:Qe,AccountSchool:Ce,school:He},Ve=({accountData:t,className:s})=>{const{class:r,birthDate:o,rating:a,school:c}=t;let l=null;return console.log("birthDate",o),o&&(l=G(new Date().getTime())),n("ul",{className:A(p.AccountInfo,s),children:[e("h3",{className:p.title,children:"Деталі"}),e("li",{className:p.classNum,children:n("p",{children:[r," клас"]})}),o&&e("li",{className:p.birthDate,children:e("span",{children:l})}),e("li",{className:p.rating,children:e("p",{children:a})}),e("li",{className:p.AccountSchool,children:e(D,{to:c.website,title:"Сайт школи",target:"_blank",className:p.school,children:c.institution_name})})]})},Oe="_container_17xg6_107",Pe="_fieldLabel_17xg6_114",Ke="_fieldErrorText_17xg6_130",We="_input_17xg6_146",Xe="_AccountHeader_17xg6_175",Ge="_cover_17xg6_178",Je="_fullName_17xg6_185",Ye="_editBtn_17xg6_209",Ze="_icon_17xg6_214",et="_avatar_17xg6_219",$={container:Oe,fieldLabel:Pe,fieldErrorText:Ke,input:We,AccountHeader:Xe,cover:Ge,fullName:Je,editBtn:Ye,icon:Ze,avatar:et};var q={},tt=B;Object.defineProperty(q,"__esModule",{value:!0});var C=q.default=void 0,st=tt(M()),nt=j,ot=(0,st.default)((0,nt.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");C=q.default=ot;const at=({className:t,name:s,surname:r,avatarUrl:o,setIsEditing:a})=>{console.log("avatar url",o);const c=()=>{a(!0)};return n("div",{className:A($.AccountHeader,t),children:[n("div",{className:$.cover,children:[e("button",{className:$.editBtn,onClick:c,children:e(C,{className:$.icon})}),n("h1",{className:$.fullName,children:[s," ",r]})]}),e(J,{className:$.avatar,src:o,name:s,surname:r,size:"lg"})]})},ct="_container_ip5r4_107",lt="_fieldLabel_ip5r4_114",rt="_fieldErrorText_ip5r4_130",it="_input_ip5r4_146",ut="_MessageBtn_ip5r4_175",_t="_btn_ip5r4_175",dt="_link_ip5r4_175",y={container:ct,fieldLabel:lt,fieldErrorText:rt,input:it,MessageBtn:ut,btn:_t,link:dt},ft=({className:t,uid:s})=>e("div",{className:A(y.MessageBtn,t),children:e(z,{color:"primary",variant:"outlined",startDecorator:e(Y,{}),className:y.btn,children:e(D,{className:y.link,to:`/chat/${s}`,children:"Написати повідомлення"})})}),mt=F.memo(({accountData:t,isMy:s,setIsEditing:r})=>{const{aboutMe:o,avatarUrl:a,uid:c,name:l,surname:_}=t;return n("div",{className:N.AccountBody,children:[e(at,{avatarUrl:a,setIsEditing:r,name:l,surname:_,className:N.header}),e("p",{className:N.about,children:o}),!s&&e(ft,{uid:c,className:N.messageBtn}),e(Ve,{accountData:t,className:N.info})]})}),ht="_container_q2nvf_108",pt="_fieldLabel_q2nvf_115",vt="_fieldErrorText_q2nvf_131",bt="_input_q2nvf_147",gt="_form_q2nvf_176",$t="_title_q2nvf_181",Nt="_body_q2nvf_201",xt="_avatar_q2nvf_206",At="_top_q2nvf_209",Et="_initialsInputs_q2nvf_212",Lt="_avatarUpload_q2nvf_215",yt="_aboutMe_q2nvf_221",Tt="_schoolInfo_q2nvf_225",St="_selectSchool_q2nvf_225",v={container:ht,fieldLabel:pt,fieldErrorText:vt,input:bt,form:gt,title:$t,body:Nt,avatar:xt,top:At,initialsInputs:Et,avatarUpload:Lt,aboutMe:yt,schoolInfo:Tt,selectSchool:St},w=600,qt=({error:t,value:s,onChange:r})=>n(U,{className:"fieldWrapper",children:[e(k,{className:"fieldLabel",children:"Про себе"}),e(Z,{error:!!t,minRows:2,maxRows:6,className:"input",defaultValue:"",value:s||void 0,onChange:r,placeholder:"Напишіть, які Ви файні"}),t&&e(ee,{className:"fieldErrorText",children:t})]}),It=F.memo(({accountData:t,setIsEdit:s})=>{const{register:r,handleSubmit:o,watch:a,formState:{errors:c},control:l,setValue:_}=te(),[i,h]=u.useState(!1),[b,E]=u.useState(null),{birthDate:ts,name:V,surname:O,school:ss}=t||{},P=S(),K=async d=>{console.log("send data",t),h(!0),await P(ce(d)),console.log("sended"),h(!1),s(!1)};return u.useEffect(()=>{_("avatar",b)},[b]),e(R,{children:n("form",{className:v.form,onSubmit:o(K),children:[e("h2",{className:v.title,children:"Змінити дані профілю"}),n("div",{className:v.body,children:[n("div",{className:v.top,children:[e("div",{className:v.avatar,children:e(se,{selectedFile:b,setSelectedFile:E,name:V,surname:O,size:96,existingAvatarUrl:t.avatarUrl||void 0})}),n("div",{className:v.textFields,children:[e(L,{control:l,name:"schoolInfo",rules:{required:"Це поле є обов'язковим",min:{value:1,message:"Тоді Ви ще не ходите в школу(1-12)"},max:{value:12,message:"Певно, Ви вже закінчили школу(1-12)"}},defaultValue:{label:t.school.institution_name,id:+t.school.institution_id},render:({field:{value:d}})=>{var g,f;return n(U,{error:!!c.schoolInfo,required:!0,children:[e(k,{children:"Навчальний заклад"}),e(ne,{error:(g=c.schoolInfo)==null?void 0:g.message,setValue:(W,X)=>{_(W,X)},value:d,inputValue:d.label}),e(oe,{children:(f=c.schoolInfo)==null?void 0:f.message})]})}}),e(L,{control:l,name:"class",defaultValue:t.class,render:({field:{value:d,onChange:g}})=>{var f;return e(ae,{error:(f=c.class)==null?void 0:f.message,onChange:g,value:d,required:!0})}})]})]}),e(L,{control:l,name:"aboutMe",defaultValue:t.aboutMe||"",rules:{maxLength:{value:w,message:`Повинно бути менше ${w} символів`}},render:({field:{value:d,onChange:g}})=>{var f;return e(qt,{error:(f=c.aboutMe)==null?void 0:f.message,onChange:g,value:d})}})]}),e(z,{className:v.submitBtn,type:"submit",children:"Зберегти"})]})})}),wt="_container_elj48_107",Dt="_fieldLabel_elj48_114",Mt="_fieldErrorText_elj48_130",Bt="_input_elj48_146",jt="_NoAccountData_elj48_175",zt="_icon_elj48_183",Ft="_text_elj48_188",T={container:wt,fieldLabel:Dt,fieldErrorText:Mt,input:Bt,NoAccountData:jt,icon:zt,text:Ft},Ut=()=>n("div",{className:T.NoAccountData,children:[e(le,{className:T.icon}),e("span",{className:T.text,children:"Користувач ще не вніс свої дані"})]}),kt="_container_1olnz_107",Rt="_fieldLabel_1olnz_114",Qt="_fieldErrorText_1olnz_130",Ct="_input_1olnz_146",Ht="_AccountQuestions_1olnz_175",Vt="_top_1olnz_178",Ot="_title_1olnz_185",Pt="__open_1olnz_200",Kt="_arrow_1olnz_200",Wt="_questionsList_1olnz_208",m={container:kt,fieldLabel:Rt,fieldErrorText:Qt,input:Ct,AccountQuestions:Ht,top:Vt,title:Ot,_open:Pt,arrow:Kt,questionsList:Wt};var I={},Xt=B;Object.defineProperty(I,"__esModule",{value:!0});var H=I.default=void 0,Gt=Xt(M()),Jt=j,Yt=(0,Gt.default)((0,Jt.jsx)("path",{d:"M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7a.9959.9959 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"}),"KeyboardArrowDownRounded");H=I.default=Yt;const Zt=({uid:t})=>{const s=x(re),[r,o]=u.useState(!1),[a,c]=u.useState(!1),l=u.useRef(null),_=S();return u.useEffect(()=>{s||(async()=>{o(!0),await _(de(t)),o(!1)})()},[a]),u.useEffect(()=>()=>{_(ie(null))},[]),console.log("condition",a&&!r&&l.current),n("div",{className:m.AccountQuestions,children:[n("button",{className:A(m.top,a&&m._open),onClick:()=>c(i=>!i),children:[n("h2",{className:m.title,children:["Запитання ",s&&`(${s.length})`]}),e(H,{className:m.arrow})]}),e("div",{className:A(m.questionsList,a&&m._open),ref:l,children:r?e(Q,{}):s?s.map(i=>e(ue,{data:i,isOpen:!1},i.id)):e("p",{className:m.noQuestions,children:"Немає запитань"})}),a&&!r&&l.current&&e(_e,{element:l.current,up:!0})]})},es=({})=>{const[t,s]=u.useState(!0),[r,o]=u.useState(!1),a=x(fe),c=x(me),l=x(he),_=x(pe),{userId:i}=ve(),h=i?c:a,b=!i;u.useEffect(()=>{s(!0),i&&E(be(i)),s(!1)},[i]),console.log("axxoun data",h);const E=S();return console.log("is fetching",l),_?l&&t||!a?e(Q,{}):e("div",{className:Le.Account,children:!r&&h?n(R,{children:[e(mt,{accountData:h,setIsEditing:o,isMy:b}),e(Zt,{uid:h.uid})]}):b?e(It,{accountData:a,setIsEdit:o}):e(Ut,{})}):e(ge,{to:"/login",replace:!0})},os=es;export{os as default};
